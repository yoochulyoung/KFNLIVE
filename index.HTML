
<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>뉴스 생방송 계산기 (웹)</title>
<style>
  :root{
    --bg:#0b1020;--card:#121933;--text:#eaf0ff;--muted:#a8b3cf;
    --btn:#1b254b;--accent:#5b8cff;--bad:#ff5b7f;
  }
  html,body{margin:0;height:100%;background:var(--bg);color:var(--text);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,'Noto Sans',Apple SD Gothic Neo,'Malgun Gothic',sans-serif}
  .wrap{max-width:640px;margin:0 auto;padding:16px}
  .card{background:var(--card);border-radius:16px;box-shadow:0 10px 25px rgba(0,0,0,.35);padding:18px}
  .title{font-size:22px;font-weight:800;margin-bottom:6px}
  .row{display:flex;align-items:center;gap:12px;margin:10px 0}
  .label{min-width:160px;text-align:right;font-size:20px}
  input[type="text"]{flex:1;background:#0e1533;border:0;border-radius:10px;color:var(--text);
    font-size:20px;padding:10px 14px;outline:none}
  button{appearance:none;border:0;border-radius:12px;background:var(--btn);color:var(--text);
    font-weight:800;font-size:18px;padding:12px 16px}
  .action{width:100%;background:var(--accent)}
  .center{display:flex;justify-content:center}
  .result{font-size:20px;text-align:center;margin-top:14px}
  .danger{color:var(--bad)}
  .muted{color:var(--muted)}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="title">뉴스 생방송 계산기</div>

      <div class="row">
        <div class="label">날씨 길이 :</div>
        <input id="inWeather" type="text" inputmode="numeric" placeholder="예: 01:30 (분:초)" aria-label="날씨 길이 (분:초)">
      </div>

      <div class="row">
        <div class="label">생방송 길이 :</div>
        <input id="inPlan" type="text" inputmode="numeric" placeholder="예: 08:00 (분:초)" aria-label="편성 생방송 길이 (분:초)">
      </div>

      <div class="row center" style="margin-top:14px">
        <button id="btnCalc" class="action">날씨 시작과 동시에 클릭</button>
      </div>

      <div id="res1" class="result"></div>
      <div id="res2" class="result danger"></div>

      <div class="result muted" style="font-size:14px">
        형식: <b>분:초</b> (예: 01:40, 23:00). 현재 기기 시간의 <b>분:초</b>에 날씨 길이를 더해 예상 생방송 시작 시각(분:초)을 구하고,<br/>
        편성 생방송 길이와의 차이를 <b>추가</b>/<b>삭제</b>로 표시합니다. (분은 60을 넘을 수 있습니다.)<br/>
        콜론(:) 입력 없이 숫자만 입력하면 자동으로 <b>mm:ss</b> 형식이 됩니다.
      </div>
    </div>
  </div>

<script>
(function(){
  const $ = sel => document.querySelector(sel);
  const inWeather = $('#inWeather');
  const inPlan    = $('#inPlan');
  const btnCalc   = $('#btnCalc');
  const res1      = $('#res1');
  const res2      = $('#res2');

  // ===== 입력 자동 mm:ss 포맷팅 & 콜론 보호 =====
  function autoColon(input){
    const prev = input.value;
    let digits = prev.replace(/\D/g,'');      // 숫자만
    if (digits.length > 6) digits = digits.slice(0,6);

    // mm:ss로 구성
    if (digits.length <= 2){
      input.value = digits;                   // "5", "45"
    } else {
      input.value = digits.slice(0, -2) + ':' + digits.slice(-2); // "1234" -> "12:34"
    }
  }

  function blockColonDelete(e){
    const val = e.target.value;
    const colonIdx = val.indexOf(':');
    if (colonIdx === -1) return;

    const s = e.target.selectionStart;
    const en = e.target.selectionEnd;

    // 콜론만 지워지는 상황 방지 (Backspace/Del, 또는 드래그로 콜론 포함 삭제)
    if ((e.key === 'Backspace' && s === colonIdx + 1 && en === colonIdx + 1) ||
        (e.key === 'Delete' && s === colonIdx && en === colonIdx) ||
        (s <= colonIdx && en > colonIdx)) {
      e.preventDefault();
    }
  }

  [inWeather, inPlan].forEach(inp => {
    inp.addEventListener('keydown', blockColonDelete, {passive:false});
    inp.addEventListener('input', () => autoColon(inp));
  });

  // ===== 파싱/포맷 함수 =====
  function parseMMSS(s){
    if (!s) return null;
    s = s.trim();
    const m = s.match(/^(\d{1,3}):([0-5]?\d)$/); // 분 0~999, 초 00~59
    if (!m) return null;
    const mm = parseInt(m[1],10), ss = parseInt(m[2],10);
    if (Number.isNaN(mm) || Number.isNaN(ss) || ss >= 60) return null;
    return mm*60 + ss;
  }

  function fmtMMSS(totalSec){
    const mm = Math.floor(totalSec / 60);
    const ss = totalSec % 60;
    const mmStr = mm < 100 ? String(mm).padStart(2,'0') : String(mm);
    const ssStr = String(ss).padStart(2,'0');
    return mmStr + ':' + ssStr;
  }

  function nowMinuteSecondTotal(){
    const now = new Date();
    return now.getMinutes()*60 + now.getSeconds();
  }

  // ===== 계산 =====
  function calc(){
    res1.textContent = '';
    res2.textContent = '';

    const nowTot = nowMinuteSecondTotal();

    const wTot = parseMMSS(inWeather.value);
    if (wTot === null){
      res1.textContent = '입력 오류';
      res2.textContent = '날씨 시간 형식 오류 (예: 00:00)';
      return;
    }
    const pTot = parseMMSS(inPlan.value);
    if (pTot === null){
      res1.textContent = '입력 오류';
      res2.textContent = '편성 시간 형식 오류 (예: 00:00)';
      return;
    }

    const liveStart = nowTot + wTot;
    res1.textContent = '예상 생방송 시간 : ' + fmtMMSS(liveStart);

    const diff = pTot - liveStart;
    const diffAbs = Math.abs(diff);
    const diffStr = fmtMMSS(diffAbs);

    if (diff > 0){
      res2.textContent = diffStr + ' 추가';
    } else if (diff < 0){
      res2.textContent = diffStr + ' 삭제';
    } else {
      res2.textContent = '00:00';
    }
  }

  // 버튼 클릭(데스크톱)
  btnCalc.addEventListener('click', calc);

  // iPhone/Safari 대응: 터치 종료 시에도 실행
  btnCalc.addEventListener('touchend', function(e){
    e.preventDefault(); // 300ms 클릭지연/중복 방지
    calc();
  }, {passive:false});

  // 모바일 키보드 엔터로도 동작
  inPlan.addEventListener('keydown', e => { if (e.key === 'Enter') calc(); });
  inWeather.addEventListener('keydown', e => { if (e.key === 'Enter') calc(); });
})();
</script>
</body>
</html>
